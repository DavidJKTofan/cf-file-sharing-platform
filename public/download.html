<!doctype html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Download Files</title>
		<link href="tailwind.css" rel="stylesheet" />
		<style>
			.hidden {
				display: none !important;
			}
			.muted {
				color: #6b7280;
			} /* tailwind gray-500 */
			.user-box {
				min-width: 220px;
				text-align: right;
			}
			.user-pill {
				display: inline-block;
				padding: 6px 10px;
				border-radius: 999px;
				font-size: 12px;
				background: #eef2ff;
				color: #3730a3;
			}
		</style>
	</head>
	<body class="bg-gray-100 min-h-screen py-8">
		<div class="container mx-auto px-4">
			<div class="max-w-7xl mx-auto bg-white rounded-2xl shadow-md p-6">
				<div class="flex items-start justify-between mb-6">
					<div>
						<h1 class="text-3xl font-semibold text-gray-800">File Manager</h1>
						<p class="text-sm text-gray-500 mt-1">Browse and download files available to you.</p>
					</div>

					<!-- Minimalistic User Info -->
					<div class="user-box">
						<div id="userEmailDisplay" class="text-sm text-gray-600">Loading user‚Ä¶</div>
						<div id="userRolesDisplay" class="text-xs mt-1">
							<span class="user-pill" id="userRolePill">Public</span>
						</div>
					</div>
				</div>

				<!-- Status messages -->
				<div id="statusMessage" class="hidden mb-4 p-3 rounded-lg"></div>

				<!-- Controls Section -->
				<div class="mb-6 space-y-4">
					<div class="flex flex-col sm:flex-row gap-4">
						<div class="flex-1">
							<input
								type="text"
								id="searchBox"
								class="w-full border border-gray-300 rounded-lg px-4 py-2 text-sm focus:ring-3 focus:ring-blue-500 focus:border-blue-500"
								placeholder="Search files by name, description, or tags..."
							/>
						</div>
						<div class="flex gap-2">
							<button id="refreshBtn" class="px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition font-medium">
								üîÑ Refresh
							</button>
							<button id="clearSearchBtn" class="px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition font-medium">
								Clear
							</button>
						</div>
					</div>

					<!-- File Stats -->
					<div id="fileStats" class="text-sm text-gray-600">
						<span id="totalFiles">Loading files...</span>
					</div>
				</div>

				<!-- Direct File Access -->
				<div class="mb-6 p-4 bg-gray-50 rounded-lg">
					<h2 class="text-lg font-medium text-gray-800 mb-3">Direct File Access</h2>
					<form id="retrieveForm" class="flex flex-col sm:flex-row gap-3">
						<div class="flex-1">
							<input
								type="text"
								id="fileId"
								name="fileId"
								required
								class="w-full border border-gray-300 rounded-lg px-3 py-2 text-sm focus:ring-3 focus:ring-blue-500 focus:border-blue-500"
								placeholder="Enter file ID for direct access"
							/>
						</div>
						<button type="submit" class="px-4 py-2 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition">
							Access File
						</button>
					</form>
				</div>

				<!-- Files Table -->
				<div class="overflow-x-auto">
					<table class="min-w-full text-sm text-left border-collapse bg-white rounded-lg overflow-hidden shadow-xs">
						<thead>
							<tr class="bg-gray-100 text-gray-700">
								<th data-col="filename" class="px-4 py-3 border-b cursor-pointer hover:bg-gray-200 transition">
									<div class="flex items-center gap-1">Filename <span class="sort-indicator">‚ÜïÔ∏è</span></div>
								</th>
								<th data-col="size" class="px-4 py-3 border-b cursor-pointer hover:bg-gray-200 transition">
									<div class="flex items-center gap-1">Size <span class="sort-indicator">‚ÜïÔ∏è</span></div>
								</th>
								<th data-col="description" class="px-4 py-3 border-b cursor-pointer hover:bg-gray-200 transition">
									<div class="flex items-center gap-1">Description <span class="sort-indicator">‚ÜïÔ∏è</span></div>
								</th>
								<th data-col="tags" class="px-4 py-3 border-b cursor-pointer hover:bg-gray-200 transition">
									<div class="flex items-center gap-1">Tags <span class="sort-indicator">‚ÜïÔ∏è</span></div>
								</th>
								<th data-col="expiration" class="px-4 py-3 border-b cursor-pointer hover:bg-gray-200 transition">
									<div class="flex items-center gap-1">Expiration <span class="sort-indicator">‚ÜïÔ∏è</span></div>
								</th>
								<th data-col="uploadedAt" class="px-4 py-3 border-b cursor-pointer hover:bg-gray-200 transition">
									<div class="flex items-center gap-1">Uploaded <span class="sort-indicator">‚ÜïÔ∏è</span></div>
								</th>
								<th class="px-4 py-3 border-b">Actions</th>
							</tr>
						</thead>
						<tbody id="fileTable" class="divide-y divide-gray-200"></tbody>
					</table>
				</div>

				<!-- Loading indicator -->
				<div id="loadingIndicator" class="text-center py-8">
					<div class="inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"></div>
					<p class="mt-2 text-gray-600">Loading files...</p>
				</div>

				<!-- Empty state -->
				<div id="emptyState" class="hidden text-center py-12">
					<div class="text-gray-400 mb-4">
						<svg class="mx-auto h-12 w-12" fill="none" stroke="currentColor" viewBox="0 0 24 24">
							<path
								stroke-linecap="round"
								stroke-linejoin="round"
								stroke-width="2"
								d="M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.98 1.98 0 013 12V7a4 4 0 014-4z"
							/>
						</svg>
					</div>
					<h3 class="text-lg font-medium text-gray-900 mb-1">No files found</h3>
					<p class="text-gray-500">Upload some files or adjust your search criteria.</p>
				</div>
			</div>
		</div>

		<script src="/js/download.js" defer></script>
	</body>
</html>
